<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-name" content="focus" />
    <title>教学管理界面</title>
    <!-- ================= Favicon ================== -->
    <!-- Standard -->
    <!-- Styles -->
    <link href="../../../static/css/lib/calendar2/pignose.calendar.min.css" rel="stylesheet">
    <link href="../../../static/css/lib/chartist/chartist.min.css" rel="stylesheet">
    <link href="../../../static/css/lib/font-awesome.min.css" rel="stylesheet">
    <link href="../../../static/css/lib/themify-icons.css" rel="stylesheet">
    <link href="../../../static/css/lib/owl.carousel.min.css" rel="stylesheet" />
    <link href="../../../static/css/lib/owl.theme.default.min.css" rel="stylesheet" />
    <link href="../../../static/css/lib/weather-icons.css" rel="stylesheet" />
    <link href="../../../static/css/lib/menubar/sidebar.css" rel="stylesheet">
    <link href="../../../static/css/lib/bootstrap.min.css" rel="stylesheet">
    <link href="../../../static/css/lib/helper.css" rel="stylesheet">
    <link href="../../../static/css/style01.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="sidebar sidebar-hide-to-small sidebar-shrink sidebar-gestures">
        <div class="nano">
            <div class="nano-content">
                <ul>
                    <div class="logo"><a href="index.html">
                        <span>Focus</span></a></div>

                    <li class="label">课程管理</li>
                    <li><a class="sidebar-sub-toggle"><i class="ti-bar-chart-alt"></i> 课程设置 <span
                                class="sidebar-collapse-icon ti-angle-down"></span></a>
                        <ul>
                            <li><a href="{{url_for('admin.adm_courses')}}">基本信息管理</a></li>
                            <li><a href="{{url_for('admin.sear_sec')}}">课程章节管理</a></li>
                        </ul>
                    </li>

                    <li><a href="{{url_for('admin.courses_talk_index')}}"><i class="ti-email"></i> 课程评价</a></li>

                    <li class="label">学习资源</li>
                    <li><a class="sidebar-sub-toggle"><i class="ti-layout"></i> 学习资源 <span
                                class="sidebar-collapse-icon ti-angle-down"></span></a>
                        <ul>
                            <li><a href="{{url_for('admin.res_index')}}">学习资源数据概述</a></li>
                            <li><a href="{{url_for('admin.adm_up_res')}}">学习资源上传</a></li>

                        </ul>
                    </li>
                    <li class="label">交流社区管理</li>
                     <li><a class="sidebar-sub-toggle"><i class="ti-layout"></i>交流社区管理  <span
                                class="sidebar-collapse-icon ti-angle-down"></span></a>
                        <ul>
                            <li><a href="{{url_for('admin.post_index')}}"><i class="ti-view-list-alt"></i>交流帖子管理</a></li>
                            <li><a href="{{url_for('admin.adm_comments_index')}}"><i class="ti-view-list-alt"></i>帖子评论管理</a></li>
                        </ul>
                    <li class="label">学员信息管理</li>
                    <li><a href="{{url_for('admin.adm_search_users')}}"><i class="ti-files"></i>学员基本信息 </a></li>
                    <li><a href="{{url_for('admin.user_sel_class')}}"><i class="ti-target"></i>学员学习信息 <span class="sidebar-collapse-icon "></span></a></li>
                    <li><a href="{{url_for('admin.output_user_info')}}"><i class="ti-file"></i>导出学生数据</a></li>
                    <li><a href="{{ url_for('admin.adm_logout')}}"><i class="ti-close"></i> 退出登录</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- /# sidebar -->

    <div class="header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="float-left">
                        <div class="hamburger sidebar-toggle">
                            <span class="line"></span>
                            <span class="line"></span>
                            <span class="line"></span>
                        </div>
                    </div>
                    <div class="float-right">
                        <div class="dropdown ">
                            <div class="header-icon" data-toggle="dropdown">
                                <span class="user-avatar">{{username}}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="content-wrap">
        <div class="main">
            <div class="container-fluid">
                <!-- /# row -->
                <section id="main-content"><div class="row">
                        <div class="col-lg-8">
                            <div  class="col-lg-12">
                                <div class="card">
                                    <h4>学习资源概览</h4>
                                      <canvas id="myChart" ></canvas>
                                </div>

                            </div>

                        </div>
                        <div class="col-lg-4">
                             <div class="col-lg-12">
                            <div class="card">
                                <div class="stat-widget-one">
                                    <div class="stat-icon dib"><i class="ti-user color-primary border-primary"></i>
                                    </div>
                                    <div class="stat-content dib">
                                        <div class="stat-text">课程数量</div>
                                        <div class="stat-digit">{{num_courses}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                            <div class="col-lg-12">
                                <div class="card">
                                    <div class="stat-widget-one">
                                        <div class="stat-icon dib"><i class="ti-layout-grid2 color-pink border-pink"></i>
                                        </div>
                                        <div class="stat-content dib">
                                            <div class="stat-text">资源数量</div>
                                            <div class="stat-digit">{{num_resources}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="card">
                                    <div class="stat-widget-one">
                                        <div class="stat-icon dib"><i class="ti-link color-danger border-danger"></i></div>
                                        <div class="stat-content dib">
                                            <div class="stat-text">学员数量</div>
                                            <div class="stat-digit">{{num_user}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                       <div class="col-lg-12">
                            <div class="card">
                                <div class="card-title pr">
                                    <div style="float:left">
                                        <h4>所有资源信息</h4>
                                    </div>
                                    <div class="ms-3 me-5 pe-5 " style="float:right" >
                                       <form class="d-flex" action="/adm_sel_res" method="post">
                                           <input type="text" name="search" style="width: 60%;height:40px;float: right" class="form-control" placeholder="输入关键字,多关键字空格隔开">
                                            <button class="btn btn-outline-success " style="margin-left: 15px" type="submit">Search</button>
                                        </form>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table student-data-table m-t-20">
                                            <thead>
                                                <tr>
                                                    <th>资源名称</th>
                                                    <th>资源类型</th>
                                                    <th>资源介绍</th>
                                                    <th>资源更新日期</th>
                                                    <th>资源下载量</th>
                                                    <th>操作</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            {% for row in  res_data %}
                                                <tr>
                                                    <td>{{row.name}}</td>
                                                    <td>{{row.file_type}}</td>
                                                    <td>{{row.description}}</td>
                                                    <td>{{row.upload_date}}</td>
                                                    <td>{{row.download_count}}</td>
                                                    <td>
                                                        <div class="btn-group">
                                                          <button type="button" class="btn btn-danger">操作</button>
                                                          <button type="button" class="btn btn-danger dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-expanded="false">
                                                            <span class="sr-only">操作</span>
                                                          </button>
                                                          <div class="dropdown-menu">
                                                            <a class="dropdown-item" href="/adm_del_res/{{row.id}}">删除</a>
                                                            <a class="dropdown-item" data-toggle="modal" data-target="#{{row.id}}">更新</a>
                                                            <td><a class="dropdown-item" href={{row.resource_path}}" download>下载</a></td>
                                                        </div>
                                                  </div>
                                                    </td>
                                                    <!-- 更新弹出框 -->
                                                    <div class="modal fade" id="{{row.id}}" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                                          <div class="modal-dialog">
                                                            <div class="modal-content">
                                                              <div class="modal-header">
                                                                <h5 class="modal-title" id="staticBackdropLabel">更新课程信息</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                  <span aria-hidden="true">&times;</span>
                                                                </button>
                                                              </div>
                                                              <div class="modal-body">
                                                               <form id="update_res" action="/update_res/{{row.id}}/{{row.file_type}}/{{row.user_id}}" method="post">
                                                                  <div>
                                                                    <label >资源名称</label>
                                                                    <input type="text"  name="res_name" class="form-control" value="{{row.name}}"  readonly>
                                                                  </div>
                                                                  <div >
                                                                    <label >资源描述</label>
                                                                    <input type="text" name="res_desc" class="form-control"  value="{{row.description}}" >
                                                                  </div>
                                                                  <div>
                                                                    <label >资源类型</label>
                                                                    <input type="text" name="res_type" class="form-control"  value="{{row.resource_type}}">
                                                                  </div>
                                                                   <div>
                                                                    <label >资源文件</label>
                                                                    <input type="file" name="res_url" class="form-control" >
                                                                  </div>
                                                                </form>
                                                              </div>
                                                              <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                                                                <button  type="submit"  form="update_res" class="btn btn-primary">确认更新</button>
                                                              </div>
                                                            </div>
                                                          </div>

                                                </tr>

                                            {% endfor%}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                </div>
                        </div>
                        <!-- /# column -->
                    </div>
                    <!-- /# row -->
                </section>
            </div>
        </div>
    </div>
    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',  // 图表类型：柱形图
            data: {
                labels: {{ labels|tojson }},  // 从 Flask 后端传递的标签数据
                datasets: [{
                    label: '资源下载概览',
                    data: {{ values|tojson }},  // 从 Flask 后端传递的数据
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
    <!-- jquery vendor -->
    <script src="../../../static/js/lib/jquery.min.js"></script>
    <script src="../../../static/js/lib/jquery.nanoscroller.min.js"></script>
    <!-- nano scroller -->
    <script src="../../../static/js/lib/menubar/sidebar.js"></script>
    <script src="../../../static/js/lib/preloader/pace.min.js"></script>
    <!-- sidebar -->

    <script src="../../../static/js/lib/bootstrap.min.js"></script>
    <script src="../../../static/js/scripts.js"></script>
    <!-- bootstrap -->

    <script src="../../../static/js/lib/calendar-2/moment.latest.min.js"></script>
    <script src="../../../static/js/lib/calendar-2/pignose.calendar.min.js"></script>
    <script src="../../../static/js/lib/calendar-2/pignose.init.js"></script>


    <script src="../../../static/js/lib/weather/jquery.simpleWeather.min.js"></script>
    <script src="../../../static/js/lib/weather/weather-init.js"></script>
    <script src="../../../static/js/lib/circle-progress/circle-progress.min.js"></script>
    <script src="../../../static/js/lib/circle-progress/circle-progress-init.js"></script>

    <script src="../../../static/js/lib/sparklinechart/jquery.sparkline.min.js"></script>
    <script src="../../../static/js/lib/sparklinechart/sparkline.init.js"></script>
    <script src="../../../static/js/lib/owl-carousel/owl.carousel.min.js"></script>
    <script src="../../../static/js/lib/owl-carousel/owl.carousel-init.js"></script>
    <!-- scripit init-->
    <script src="../../../static/js/dashboard2.js"></script>
</body>
<script>
        $('#myModal').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
})
    </script>
<script>

</script>
</html>
